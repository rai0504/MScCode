clc
clear
close all
fmax = 2*sqrt(2)+4;
% image 1
u1 = [1, 1, 1, 1, 1];
a1 = [40,40,40,40,45];
l11 = [100,50,50,50,150];
l01 = a1.*l11;
c01 = [0.00690927,0.00680261,0.0068178,0.00678771,0.00680018];
c11 = [0.110953,0.110618,0.110658,0.110583,0.110654];
s01 = [0.00835448,0.00811538,0.00815475,0.00807488,0.00808699];
s11 = [0.110953,0.110618,0.110658,0.110583,0.110654];
d1 = c11-c01;
pe1 = c01+(d1)./(sqrt(a1)+1);
a = l01-l11;
b = -2*l01.*c01 + 2*l11.*c11;
c = l01.*c01.^2-l11.*c11.^2-fmax;
h1 = (-b+sqrt(b.^2-4*a.*c))./(2*a);
percPe1 = (pe1-c01)./(d1);
percH1 = (h1-c01)./(d1);
fprintf('Image 1: mean(c0) = %f, mean(c1) = %f, std(c0) = %f, std(c1) = %f\n', mean(c01),mean(c11),std(c01),std(c11));

% image 2
u2 = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];
a2 = [30,40,40,40,40,45,50,30,40,40,40,40,45,50,30,40,40,40,40,45,50];
l12 = [150,50,100,150,200,150,150,150,50,100,150,200,150,150,150,50,100,150,200,150,150];
l02 = a2.*l12;
c02 = [0.00764026,0.00744854,0.00742781,0.0074239,0.00744085,0.00742333,0.00729669,0.00764026,...				
    0.00744854,0.00742781,0.0074239,0.00744085,0.00742333,0.00729669,0.0075563,0.00756818,...
    0.0075643,0.00756564,0.00755831,0.00746725,0.00734272];
c12 = [0.309246,0.308057,0.30789,0.307975,0.308094,0.307976,0.307166,0.309246,0.308057,...				
    0.30789,0.307975,0.308094,0.307976,0.307166,0.308779,0.308796,0.308815,0.308838,...				
    0.3088,0.30826,0.30747];
s02 = [0.0117809,0.0112543,0.0111757,0.011158,0.0112005,0.0111549,0.0108029,...				
    0.0117809,0.0112543,0.0111757,0.011158,0.0112005,0.0111549,0.0108029,0.0115322,...				
    0.011587,0.0115595,0.0115574,0.0115341,0.0112736,0.0109286];
s12 = [0.14503,0.145631,0.145657,0.145655,0.145592,0.145654,0.146064,0.14503,...				
    0.145631,0.145657,0.145655,0.145592,0.145654,0.146064,0.145254,0.145259,0.145239,...				
    0.145224,0.145241,0.145508,0.145908];
d2 = c12-c02;
pe2 = c02+(d2)./(sqrt(a2)+1);
a = l02-l12;
b = -2*l02.*c02 + 2*l12.*c12;
c = l02.*c02.^2-l12.*c12.^2-fmax;
h2 = (-b+sqrt(b.^2-4*a.*c))./(2*a);
percPe2 = (pe2-c02)./(d2);
percH2 = (h2-c02)./(d2);
fprintf('Image 2: mean(c0) = %f, mean(c1) = %f, std(c0) = %f, std(c1) = %f\n', mean(c02),mean(c12),std(c02),std(c12));

% image 3
u3 = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];
a3 = [10,10,10,20,30,10,10,10,20,30,10,10,10,20,30];
l13 = [150,200,400,150,150,150,200,400,150,150,150,200,400,150,150];
l03 = a3.*l13;
c03 = [0.0413662,0.0413641,0.0413586,0.0413228,0.0412669,0.0413662,0.0413641,...				
    0.0413586,0.0413228,0.0412669,0.0413623,0.0413572,0.0413558,0.0413214,0.041262];
c13 = [0.0963273,0.096323,0.096339,0.0958484,0.0949999,0.0963273,0.096323,...
    0.096339,0.0958484,0.0949999,0.0962833,0.09626,0.0963093,0.0958361,0.0949228];
s03 = [0.00953587,0.00953336,0.00952811,0.00950762,0.00947405,0.00953587,0.00953336,...			
    0.00952811,0.00950762,0.00947405,0.00953319,0.00952799,0.00952623,0.00950693,0.00947236];
s13 = [0.0295032,0.294983,0.0294652,0.0296368,0.0299513,0.0295032,0.0294983,0.0294652,...				
    0.0296368,0.0299513,0.0295165,0.029512,0.029473,0.0296388,0.0299779];
d3 = c13-c03;
pe3 = c03+(d3)./(sqrt(a3)+1);
a = l03-l13;
b = -2*l03.*c03 + 2*l13.*c13;
c = l03.*c03.^2-l13.*c13.^2-fmax;
h3 = (-b+sqrt(b.^2-4*a.*c))./(2*a);
percPe3 = (pe3-c03)./(d3);
percH3 = (h3-c03)./(d3);
fprintf('Image 3: mean(c0) = %f, mean(c1) = %f, std(c0) = %f, std(c1) = %f\n', mean(c03),mean(c13),std(c03),std(c13));

% image 4
u4 = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];
a4 = [30,30,30,40,40,30,30,30,40,40,30,30,30,40,40];
l14 = [50,100,150,100,150,50,100,150,100,150,50,100,150,100,150];
l04 = a4.*l14;
c04 = [0.0403399,0.0403276,0.0403189,0.0402401,0.0402641,0.0403564,0.0403431,...				
    0.0403388,0.0402325,0.0402603,0.0402617,0.0402535,0.0402366,0.0402357,0.0402247];
c14 = [0.131121,0.131038,0.130976,0.129694,0.130244,0.131362,0.131304,0.131307,...				
    0.129556,0.130177,0.129873,0.129884,0.129708,0.129624,0.129532];
s04 = [0.00989826,0.0098757,0.00985223,0.00979678,0.00980266,0.00991197,0.00988346,...				
    0.00987218,0.0097918,0.00980043,0.0098433,0.00981958,0.0097914,0.00979381,0.00977324];
s14 = [0.053776,0.0537829,0.053795,0.0541799,0.0539862,0.0537062,0.0536987,0.0536861,...				
    0.0542234,0.0540076,0.0541466,0.0541214,0.0541613,0.0542,0.054215];
d4 = c14-c04;
pe4 = c04+(d4)./(sqrt(a4)+1);
a = l04-l14;
b = -2*l04.*c04 + 2*l14.*c14;
c = l04.*c04.^2-l14.*c14.^2-fmax;
h4 = (-b+sqrt(b.^2-4*a.*c))./(2*a);
percPe4 = (pe4-c04)./(d4);
percH4 = (h4-c04)./(d4);
fprintf('Image 4: mean(c0) = %f, mean(c1) = %f, std(c0) = %f, std(c1) = %f\n', mean(c04),mean(c14),std(c04),std(c14));

% image 5
u5 = [1,1,1,1,1,1,1,1,1,1,1,1];
a5 = [30,30,40,50,30,30,40,50,30,30,40,50];
l15 = [50,150,150,150,50,150,150,150,50,150,150,150];
l05 = a5.*l15;
c05 = [0.0347557,0.0347574,0.0346753,0.0344873,0.0347557,0.0347574,0.0346753,0.0344873,...				
    0.0346828,0.0346812,0.0345817,0.0345803];
c15 = [0.201631,0.201659,0.20063,0.197806,0.201631,0.201659,0.20063,0.197806,0.200718,...				
    0.200701,0.199297,0.19928];
s05 = [0.0060267,0.00605048,0.00578283,0.00527256,0.0060267,0.00603048,0.00578283,...				
    0.00527256,0.00580728,0.00580147,0.0055218,0.00551729];
s15 = [0.0703503,0.0703298,0.070997,0.0728689,0.0703503,0.0703298,0.070997,...				
    0.0728689,0.079452,0.0709525,0.0718795,0.0718902];
d5 = c15-c05;
pe5 = c05+(d5)./(sqrt(a5)+1);
a = l05-l15;
b = -2*l05.*c05 + 2*l15.*c15;
c = l05.*c05.^2-l15.*c15.^2-fmax;
h5 = (-b+sqrt(b.^2-4*a.*c))./(2*a);
percPe5 = (pe5-c05)./(d5);
percH5 = (h5-c05)./(d5);
fprintf('Image 5: mean(c0) = %f, mean(c1) = %f, std(c0) = %f, std(c1) = %f\n', mean(c05),mean(c15),std(c05),std(c15));

% image 6
u6 = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];
a6 = [20,20,30,30,40,40,50,50,20,20,30,30,40,40,50,50,20,20,30,30,40,40,50,50];
l16 = [20,150,50,150,50,150,50,150,20,150,50,150,50,150,50,150,20,150,50,150,50,150,50,150];
l06 = a6.*l16;
c06 = [0.00296389,0.00293176,0.00153289,0.00152068,0.00181657,0.00181473,0.00125972,...				
    0.0012397,0.00296389,0.00293176,0.00153289,0.00152068,0.00181657,0.00181473,0.00125972,...				
    0.0012397,0.00264255,0.0025839,0.00225155,0.00224574,0.00152674,0.00151845,0.00165488,0.00164466];
c16 = [0.251959,0.251781,0.228802,0.23869,0.242106,0.242097,0.23513,0.234857,0.251959,...				
    0.251781,0.228802,0.23869,0.242106,0.242097,0.23513,0.234857,0.249529,0.249164,0.24637,...				
    0.246324,0.238746,0.238667,0.240298,0.240193];
s06 = [0.0115126,0.0113813,0.00628141,0.0062246,0.00733904,0.00732936,0.00523876,0.00515693,...				
    0.0115126,0.0113813,0.00628141,0.0062246,0.00733904,0.00732936,0.00523876,0.00515693,...				
    0.0103893,0.0101463,0.00894319,0.00891979,0.00625266,0.00621492,0.00673391,0.00669137];
s16 = [0.100036,0.100113,0.107555,0.107612,0.105592,0.105595,0.109741,0.109899,0.100036,...				
    0.100113,0.107555,0.107612,0.105592,0.105595,0.109741,0.109899,0.10137,0.101541,0.103114,...				
    0.103138,0.107583,0.107625,0.1066,0.106718];
d6 = c16-c06;
pe6 = c06+(d6)./(sqrt(a6)+1);
a = l06-l16;
b = -2*l06.*c06 + 2*l16.*c16;
c = l06.*c06.^2-l16.*c16.^2-fmax;
h6 = (-b+sqrt(b.^2-4*a.*c))./(2*a);
percPe6 = (pe6-c06)./(d6);
percH6 = (h6-c06)./(d6);
fprintf('Image 6: mean(c0) = %f, mean(c1) = %f, std(c0) = %f, std(c1) = %f\n', mean(c06),mean(c16),std(c06),std(c16));

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% CONCATENATED RESULTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
u = [u1,u2,u3,u4,u5,u6];
a = [a1,a2,a3,a4,a5,a6];
l1 = [l11,l12,l13,l14,l15,l16];
l0 = [l01,l02,l03,l04,l05,l06];
c0 = [c01,c02,c03,c04,c05,c06];
c1 = [c11,c12,c13,c14,c15,c16];
s0 = [s01,s02,s03,s04,s05,s06];
s1 = [s11,s12,s13,s14,s15,s16];
percPe = [percPe1,percPe2,percPe3,percPe4,percPe5,percPe6];
percH = [percH1,percH2,percH3,percH4,percH5,percH6];
fprintf('Dpe: mean = %f, median=%f, std = %f\n', mean(percPe),median(percPe),std(percPe));
fprintf('Dh: mean = %f, median=%f, std = %f\n\n', mean(percH),median(percH),std(percH));




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% BOUNDS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
uLB = (l1.*(a.*c0.^2-c1.^2))/(fmax);
l1UB = (u*fmax)./(a.*c0.^2-c1.^2);


